---
import PeopleCard from "../components/PeopleCard.astro";
import UsefulCard from "../components/UsefulCard.astro";
import BaseLayoutSnow from "../layouts/BaseLayoutSnow.astro";

const courses = [
    {
        title: "Основы веб-технологий",
        href: `/web-course-site/labs/web-tech`,
        descr: "Изучаем, как работает браузер, рассматриваем адаптивную верстку и ключевые принципы доступности",
    },
    {
        title: "Основы веб-разработки",
        href: `/web-course-site/labs/web-client-dev`,
        descr: "Изучаем основы JavaScript и знакомимся с различными API, предоставляемыми браузером",
    },
    {
        title: "Веб-разработка на клиенте",
        href: `/web-course-site/labs/web-client-dev-ts`,
        descr: "Изучаем основы работы с типами и язык TypeScript, а также осваиваем применение фреймворка Vue",
    },
];

const teachers = [
    {
        name: "Верещагин Владислав Юрьевич",
        imgUrl: "./src/assets/img/photos/slavaver.png",
        role: "Кандидат технических наук",
    },
    {
        name: "Гнибеда Артем Юрьевич",
        imgUrl: "./src/assets/img/photos/gnibedaArtem.png",
        role: "",
    },
];

const mentors = [
    {
        name: "Мелихова Ева",
        imgUrl: "./src/assets/img/photos/sshultse.png",
        role: "Ассистент преподавателя",
    },
    {
        name: "Хаметов Артем",
        imgUrl: "./src/assets/img/photos/hametov.png",
        role: "Ассистент преподавателя",
    },
    {
        name: "Бастун Андрей",
        imgUrl: "",
        role: "Наставник",
    },
    {
        name: "Старцев Виталий",
        imgUrl: "./src/assets/img/photos/vitaliy.png",
        role: "Наставник",
    },
];

import { getCollection } from "astro:content";
const allUseful = await getCollection("useful");
const lengths = allUseful.map((post) => post.body.length);

const usefulItems = allUseful.map((item, index) => ({
    ...item,
    length: lengths[index],
}));

const usefulStatic = [
    usefulItems.find((post) => post.slug === "rules")!,
    usefulItems.find((post) => post.slug === "links")!,
];

const usefulDynamic = usefulItems
    .filter((post) => post.slug !== "rules" && post.slug !== "links")
    .sort(() => Math.random() - 0.5)
    .slice(0, 2);

const useful = [...usefulStatic, ...usefulDynamic];
---

<BaseLayoutSnow>
    <section
        class="section-hero bg-bg-primary rounded-b-[30px] sm:rounded-b-[60px] h-[600px] sm:h-2xl md:h-3xl relative mb-15"
    >
        <div
            class="hero-container flex flex-col justify-end h-full text-center items-center"
        >
            <h1
                class="line-height-[1] font-size-32px md:font-size-72px lg:font-size-82px"
            >
                Веб-разработка
            </h1>
            <h2
                class="line-height-[1] font-size-24px md:font-size-40px lg:font-size-48px font-400 mb-5"
            >
                от теории к практике
            </h2>
            <p class="mb-7.5 w-2/3 sm:max-w-1/3">
                Три курса последовательно погружают в разработку на стороне
                клиента
            </p>
            <img
                src="./src/assets/img/cat-code.svg"
                alt="смешной котик программирует"
            />
        </div>
    </section>
    <section class="section-courses pt-15 mb-30" id="courses">
        <div
            class="courses-container max-w-screen px-5 md:px-15 xl:px-0 xl:max-w-screen-xl mx-auto"
        >
            <h2 class="courses-title light:text-text-secondary title">Курсы</h2>
            <ul class="courses-list flex flex-col gap-5">
                {
                    courses.map((course) => (
                        <a href={course.href}>
                            <li class="courses-item rounded-[30px] bg-bg-secondary p-5 md:p-7.5 lg:p-10 userActions">
                                <div class="flex flex-col md:flex-row justify-between ">
                                    <h3 class="courses-item-title no-break-hyphen">
                                        {course.title}
                                    </h3>
                                    <div class="max-w-auto md:max-w-[360px] gap-14 flex flex-col items-end">
                                        <p class="courses-item-descr">
                                            {course.descr}
                                        </p>
                                        <button class="courses-item-btn" />
                                    </div>
                                </div>
                            </li>
                        </a>
                    ))
                }
                <button
                    class="font-titles font-600 bg-bg-accent_second px-11.5 py-5 rounded-[20px] userActionsLinkAlt"
                    onclick={`window.location.href='/web-course-site/courses/'`}
                    >Показать все</button
                >
            </ul>
        </div>
    </section>
    <section class="section-teachers mb-30">
        <div
            class="teachers-container max-w-screen px-5 md:px-15 xl:px-0 xl:max-w-screen-xl mx-auto"
        >
            <h2 class="teachers-title title light:text-text-secondary">
                Преподаватели
            </h2>
            <ul
                class="teachers-list grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-5"
            >
                {teachers.map((teacher) => <PeopleCard person={teacher} />)}
            </ul>
        </div>
    </section>
    <section
        id="useful"
        class="section-useful bg-bg-primary py-15 rounded-[30px] sm:rounded-[60px] mb-30"
    >
        <div
            class="useful-container max-w-screen px-5 md:px-15 xl:px-0 xl:max-w-screen-xl mx-auto"
        >
            <h2 class="useful-title title">База знаний</h2>
            <ul
                class="useful-list grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-5"
            >
                {
                    useful
                        .slice(0, 2)
                        .map((useful) => <UsefulCard useful={useful} />)
                }
                <p class="order-0">
                    Здесь вы найдете подборки полезных ресурсов, конспекты, а
                    также статьи с теорией, раскрывающие ключевые темы курсов
                </p>
                <div class="hidden sm:block">
                    <UsefulCard useful={useful[2]} />
                </div>
                <div
                    class="other-useful flex flex-col justify-between order-1 lg:order-0"
                >
                    <img
                        src="./src/assets/img/cat-chill.svg"
                        alt="чилл кот лежит за ноутбуком"
                    />
                    <button
                        class="font-titles font-600 bg-bg-accent_second sm:px-5 px-11.5 py-5 rounded-[20px] userActionsLinkAlt"
                        onclick={`window.location.href='/web-course-site/useful/'`}
                        >Еще больше полезностей</button
                    >
                </div>
                <div class="hidden sm:block">
                    <UsefulCard useful={useful[3]} />
                </div>
            </ul>
        </div>
    </section>
    <section class="section-mentors mb-30 light:text-text-secondary">
        <div
            class="mentors-container max-w-screen px-5 md:px-15 xl:px-0 xl:max-w-screen-xl mx-auto"
        >
            <h2 class="mentors-title title">Наставники</h2>
            <ul
                class="mentors-list grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 2xl:grid-cols-3 gap-5"
            >
                <PeopleCard person={mentors[0]} />
                <p class="order--1 xl:order-0 px-1">
                    Мы поддерживаем вас на пути освоения первых двух курсов,
                    помогаем разобраться в сложных моментах и направляем на
                    верное решение задач
                </p>
                <PeopleCard person={mentors[1]} />
                <div
                    class="other-mentors flex flex-col gap-5 order-1 2xl:order-0"
                >
                    <img
                        class="h-[100vw] sm:h-[45vw] lg:h-[30vw] xl:h-380px 2xl:h-430px"
                        src="./src/assets/img/paw-heart.svg"
                        alt="Лапка котика с сердечками"
                    />
                    <button
                        class="font-titles text-text-primary font-600 bg-bg-accent_second px-11.5 py-5 rounded-[20px] userActionsLinkAlt"
                        onclick={`window.location.href='/web-course-site/useful/contact'`}
                        >Смотреть всех</button
                    >
                </div>
                {
                    mentors
                        .slice(2)
                        .map((mentor) => <PeopleCard person={mentor} />)
                }
            </ul>
        </div>
    </section>

    <style>
        .section-hero,
        .section-useful {
            position: relative;
            overflow: hidden;
            z-index: 1;
        }

        .section-hero::before,
        .section-useful::before {
            content: "";
            position: absolute;
            z-index: -1;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: var(--color-bg-accent-first);
            -webkit-mask-image: url('data:image/svg+xml,%3Csvg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 1440 728" fill="none"%3E%3Cpath d="M-384.828 550.33C-279.518 431.882 -29.173 211.72 129.724 278.664C328.344 362.345 -156.414 623.403 -2.48331 780.746C176.815 964.017 967.034 -77.2714 1180.55 48.249C1394.07 173.769 1062.62 452.507 1180.55 550.33C1274.9 628.589 1460.28 401.827 1541.17 278.664" stroke="black" stroke-width="150"/%3E%3C/svg%3E');
            mask-image: url('data:image/svg+xml,%3Csvg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 1440 728" fill="none"%3E%3Cpath d="M-384.828 550.33C-279.518 431.882 -29.173 211.72 129.724 278.664C328.344 362.345 -156.414 623.403 -2.48331 780.746C176.815 964.017 967.034 -77.2714 1180.55 48.249C1394.07 173.769 1062.62 452.507 1180.55 550.33C1274.9 628.589 1460.28 401.827 1541.17 278.664" stroke="black" stroke-width="150"/%3E%3C/svg%3E');
            -webkit-mask-repeat: no-repeat;
            mask-repeat: no-repeat;
            -webkit-mask-size: cover;
            mask-size: cover;
        }

        .courses-item-btn {
            background: url("./src/assets/img/goto.svg") no-repeat center;
            width: 50px;
            height: 50px;
            border: 1.5px solid var(--color-border);
            border-radius: 100%;
            color: var(--color-border);
        }
    </style>
</BaseLayoutSnow>

<script>
    document.querySelectorAll(".no-break-hyphen").forEach((el) => {
        el.innerHTML = el.innerHTML.replace(/-/g, "&#8209;");
    });
</script>
